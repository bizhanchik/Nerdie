# Функционал уроков и персонализации

Я успешно добавил полноценный функционал для уроков с онбордингом и персонализацией. Вот что было реализовано:

## Новые возможности

### 1. Онбординг
- При первом запуске приложения пользователь проходит двухэтапный онбординг
- **Этап 1**: Ввод возраста
- **Этап 2**: Выбор интересов из предложенных или добавление своих
- Данные сохраняются в AsyncStorage и используются для персонализации уроков

### 2. Автоматическая генерация уроков
- После обработки каждой лекции автоматически генерируется персонализированный урок
- Урок создается с учетом возраста и интересов пользователя
- AI адаптирует примеры и объяснения под интересы пользователя

### 3. Экран "Мои уроки"
- Отображает все созданные уроки
- Фильтры: Все / Активные / Завершенные
- Показывает прогресс и оценки за пройденные уроки
- Каждая карточка урока содержит:
  - Название и описание
  - Время прохождения
  - Количество вопросов
  - Статус завершения
  - Оценку (для завершенных уроков)

### 4. Прохождение урока
- Две вкладки: **Урок** и **Квиз**
- **Вкладка "Урок"**:
  - Полное содержание урока в формате Markdown
  - Чёткое форматирование с заголовками, списками, выделениями
  - Примеры адаптированы под интересы пользователя

- **Вкладка "Квиз"**:
  - 5-7 вопросов разных типов:
    - Множественный выбор
    - Верно/Неверно
    - Краткий ответ
  - Мгновенная обратная связь после каждого ответа
  - Подробные объяснения правильных ответов
  - Итоговая оценка после завершения

### 5. Персонализация уроков
- AI использует информацию о возрасте и интересах пользователя
- Примеры адаптируются под интересы:
  - Интерес к спорту → спортивные аналогии
  - Интерес к музыке → музыкальные примеры
  - И так далее
- Сложность объяснений учитывает возраст

## Структура данных

### UserProfile
```typescript
{
  id: string;
  age?: number;
  interests: string[];
  hasCompletedOnboarding: boolean;
  createdAt: number;
}
```

### Lesson
```typescript
{
  id: string;
  lectureId: string;
  title: string;
  description: string;
  content: string; // Markdown
  questions: LessonQuestion[];
  estimatedDuration: number; // minutes
  createdAt: number;
  completed: boolean;
  score?: number; // 0-100%
  completedAt?: number;
}
```

### LessonQuestion
```typescript
{
  id: string;
  type: 'multiple_choice' | 'true_false' | 'short_answer';
  question: string;
  options?: string[]; // For multiple choice
  correctAnswer: string;
  explanation: string;
}
```

## Новые файлы

1. **src/screens/OnboardingScreen.tsx** - Экран онбординга
2. **src/screens/LessonTakeScreen.tsx** - Экран прохождения урока
3. **src/components/common/LessonCard.tsx** - Карточка урока
4. **src/types/index.ts** - Расширенные типы для уроков и профиля

## Обновленные файлы

1. **App.tsx** - Добавлена логика онбординга и новые роуты
2. **src/screens/LessonsScreen.tsx** - Полная реализация экрана уроков
3. **src/screens/RecordScreen.tsx** - Интегрирована генерация уроков
4. **src/services/storage.ts** - Добавлены методы для работы с профилем и уроками
5. **src/services/openai.ts** - Добавлен метод `generatePersonalizedLesson()`

## Как это работает

### Процесс создания урока

1. Пользователь записывает лекцию
2. Система обрабатывает аудио (транскрипция + учебные материалы)
3. **Автоматически генерируется персонализированный урок**:
   - Берется транскрипция, summary и notes
   - Загружается профиль пользователя
   - AI создает урок с учетом интересов и возраста
   - Урок сохраняется в AsyncStorage
4. Урок становится доступен на вкладке "Lessons"

### Прохождение урока

1. Пользователь открывает урок из списка
2. Читает материал урока
3. Переходит к квизу
4. Отвечает на вопросы с мгновенной обратной связью
5. Получает итоговую оценку
6. Урок помечается как завершенный

## Преимущества

- **Персонализация**: Каждый урок адаптирован под конкретного пользователя
- **Автоматизация**: Уроки создаются автоматически, без участия пользователя
- **Интерактивность**: Квизы с мгновенной обратной связью
- **Прогресс**: Отслеживание завершенных уроков и оценок
- **UX**: Простой и понятный интерфейс

## Возможные улучшения

1. Повторное прохождение уроков
2. Статистика по всем урокам
3. Экспорт результатов
4. Режим обучения с подсказками
5. Адаптивная сложность вопросов
6. Социальные функции (сравнение с друзьями)
7. Достижения и награды

## Технические детали

- Все данные хранятся локально в AsyncStorage
- Генерация уроков использует GPT-4o от OpenAI
- Поддержка markdown для форматирования контента
- Responsive дизайн для разных размеров экранов
- Обработка ошибок с graceful degradation
